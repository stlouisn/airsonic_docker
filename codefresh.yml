version: '1.0'
steps:
    build_image:
        title: Building Docker Image
        type: build
        dockerfile: Dockerfile
        image_name: stlouisn/subsonic
        tag: latest
        #working_directory: ${{main_clone}}

    push_to_registry:
        title: Pushing to Docker Registry
        type: push
        candidate: '${{build_image}}'
        tag: latest
        credentials:
            username: '${{dockerUsername}}'
            password: '${{dockerPassword}}'
    
    slack_notify:
        image: tutum/curl
        commands:
            - curl -X POST --data-urlencode 'payload={"text":"Test slack integration via yaml"}' ${{SLACK_WEB_URL}}